<html xmlns="http://www.thymeleaf.org">

<head>

	<title>List Transactions</title>
	<link href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css" rel="stylesheet">
	<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
	<script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>

</head>

<body>
	<header>
	<span sec:authorize="isAuthenticated()">
                | Logged user: <span sec:authentication="name"></span> |
                Roles: <span sec:authentication="principal.authorities"></span> |
                <form id="logoutForm" method="POST" th:action="@{/logout}">
		            <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
		            
		        </form>
		         <a onclick="document.forms['logoutForm'].submit()">Logout</a>
            </span>
            
            <a href="/contact">Contact</a>
            <a href="/">Home</a>
            <a href="/showTransaction">Transaction</a>
            <a href="/profile">Profile</a>
            
	</header>

	

	<h2>Send Money</h2>
	<hr />
	<a href="/addConnection">
	Add Connection</a>
	
	<form th:action="@{/showTransaction}" th:object="${transactionForm}" method="POST">
		Connection:
		
		<select th:field="*{destinataire}">
			 <option th:each="connection : ${connections}" th:value="${connection.idDestinataire+'-'+connection.nom}" th:text="${connection.nom}">
		    </option>
		</select>


		<br />
		Montant:
		<input type="text" th:field="*{montant}" />
		<br />
		Description:
		<input type="text" th:field="*{description}" />
		<br />
		
		<input type="submit" value="Pay" />
	</form>

	<div>



		<h2>List Transactions</h2>
		<hr />
		<table id="datatable1" border="1">

			<thead>
				<tr>
					<th>Connection</th>
					<th>Description</th>
					<th>Amount</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="transaction: ${transactions}">
					<td th:text="${transaction.nom}"></td>
					<td th:text="${transaction.description}"></td>
					<td th:text="${transaction.montant}"></td>
				</tr>
			</tbody>

		</table>
	</div>
</body>

<script>
	$(document).ready(function () {
		$('#datatable1').DataTable();
	});
</script>

</html>